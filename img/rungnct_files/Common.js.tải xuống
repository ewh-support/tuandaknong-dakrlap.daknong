var _arrJs=[];var _arrCss=[];var _arrJsEd=[];var _npsPortalObj=[];function loadScript(src,callback){var s,r,t;r=false;s=document.createElement('script');s.type='text/javascript';s.src=src;s.async=false;s.onload=s.onreadystatechange=function(){if(!r&&(!this.readyState||this.readyState=='complete')){r=true;callback();}};t=document.getElementsByTagName("head")[0];t.appendChild(s);}function addScript(src,type){if(type==null||type==1){if(_arrJs.indexOf(src)<0){_arrJs.push(src);}}else{if(_arrCss.indexOf(src)<0){_arrCss.push(src);}}}function execLoadCss(){while(_arrCss.length>0){var strUrl=_arrCss.shift(_arrCss);loadCSS(strUrl);}}function execVTScript(callback){if(_arrJs.length>0){var strUrl=_arrJs.shift(_arrJs);var filename=strUrl.replace(/^.*[\\\/]/,'');var parIndex=filename.indexOf("?");if(filename>-1){filename=filename.substring(0,parIndex);}if(_arrJsEd.indexOf(filename)<0){loadScript(strUrl,function(){_arrJsEd.push(filename);execVTScript(callback);});}else{execVTScript(callback);}}else{if(typeof callback==='function'){callback();}}}var _tempPlateIndex=1;function loadDataTemplate(tmpUrl,dataUrl,callback){if(typeof dataUrl==="string"){$.get(tmpUrl,function(templateData,textStatus,XMLHttpRequest){var templateName="template_auto"+_tempPlateIndex;$.template(templateName,templateData);_tempPlateIndex=_tempPlateIndex+1;$.get(dataUrl,function(objData,textStatus,XMLHttpRequest){if(objData!=null&&objData.status=="SUCCESS"){var strHtml=$.tmpl(templateName,objData);if(callback!=null){callback(strHtml,templateData,objData.data);}}});});}else{$.get(tmpUrl,function(templateData,textStatus,XMLHttpRequest){var templateName="template_auto"+_tempPlateIndex;$.template(templateName,templateData);_tempPlateIndex=_tempPlateIndex+1;var strHtml=$.tmpl(templateName,dataUrl);if(callback!=null){callback(strHtml,templateData,dataUrl.data);}});}}function LoadJqueryTemplate(templatePath,elementOrElementId,callback){$.get("/Scripts/JsTemplate/"+templatePath+".html",function(templateData,textStatus,XMLHttpRequest){if(textStatus==="success"&&templateData!==""){var ElementTo=null;if(elementOrElementId!==undefined&&elementOrElementId!==null){if(typeof elementOrElementId==="string")ElementTo=$(elementOrElementId);else ElementTo=$(elementOrElementId);}else ElementTo=$(document.body);if(ElementTo.length>0)ElementTo.append(templateData);if(callback!=null&&callback!=undefined){callback();}}});}function AddVersion(url){var newUrl=url;try{var dtNow=new Date();var verPar=dtNow.getTime();if(url.indexOf('?')>-1)newUrl+="&ver="+verPar;else newUrl+="?ver="+verPar;}catch(e){console.log(e);}return newUrl;}function getParameterByName(name){name=name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(location.search);return results==null?"":decodeURIComponent(results[1].replace(/\+/g," "));}function FuncPostFileAPI(data,api,onSuccess,onFailed){$.ajax({url:api,type:'POST',cache:false,scriptCharset:"utf8",dataType:'json',data:data,processData:false,contentType:false,success:onSuccess,error:onFailed===undefined?OnRequestFailed:onFailed});}function FuncPostAPI(data,api,onSuccess,onFailed){$.ajax({url:api,type:'POST',cache:false,scriptCharset:"utf8",dataType:'json',data:data,success:onSuccess,error:onFailed===undefined?OnRequestFailed:onFailed});}function FuncGetAPI(api,onSuccess,onFailed){$.ajax({url:api,type:'GET',cache:false,success:onSuccess,error:onFailed===undefined?OnRequestFailed:onFailed});}function OnRequestFailed(result){}function GetTimeSpan(curDate,iLCID){var result='';try{var ToDate=new Date();var FromDate=new Date(curDate);var dateDiff=ToDate.getTime()-FromDate.getTime();var Dspan=Math.round(dateDiff/(24*60*60*1000));if(Dspan>30)result=FromDate.getDate()+"/"+(FromDate.getMonth()+1)+"/"+FromDate.getFullYear();else if(Dspan>0)result=(iLCID==1066?Dspan+" ngày trước":Dspan+" days ago");else{var Hspan=Math.round(dateDiff/(60*60*1000));if(Hspan>0)result=(iLCID==1066?"Lúc":"On")+" "+FromDate.getHours()+":"+FromDate.getMinutes();else{var Mspan=Math.round(dateDiff/(60*1000));if(Mspan==0){result=(iLCID==1066?"Vài giây trước":"A few seconds ago");}else
result=(iLCID==1066?Mspan+" phút trước":Mspan+" minutes ago");}}}catch(e){}return result;}function showDialog(url,title,funtion){var uploadwindow=$("#windowbysize");var widthOfForm=$(window).width()/100*90;var heightOfForm=$(window).height()/100*90;if($("#HiddenValuePopup").length==0){$("#contentRow").append("<input type='hidden' id='HiddenValuePopup'/>");$("#HiddenValuePopup").val("");}if(uploadwindow.length==0){$("#contentRow").append("<div id='windowbysize'></div>");uploadwindow=$("#windowbysize");}if(parent.$("#windowbysize").data("kendoWindow")!=undefined){widthOfForm=parent.$("#windowbysize").width()-30;heightOfForm=parent.$("#windowbysize").height()-50;parent.$("#windowbysize").addClass("header-vt");}if(!uploadwindow.data("kendoWindow")){uploadwindow.kendoWindow({actions:["Close"],iframe:true,visible:false,content:"",close:function(){if(typeof(funtion)==='string'){eval(funtion);}else{funtion();}parent.$("#windowbysize").removeClass("header-vt");uploadwindow.find("#windowbysize").remove();this.destroy();document.body.className='';},refresh:function(){uploadwindow.find(".processcustome-loading").remove();},resizable:false,open:function(){$("body").addClass("fixContent");uploadwindow.append("<div class='processcustome-loading'><img id='img-pro' src='/images/loading.gif'><span>Vui lòng đợi...</span></div>");uploadwindow.width(widthOfForm);uploadwindow.height(heightOfForm);uploadwindow.data("kendoWindow").center();},modal:true});}if(url.indexOf("?")>0)url=url+"&IsDlg=1";else
url=url+"?IsDlg=1";var kendoWindowElement=uploadwindow.data("kendoWindow");if(kendoWindowElement!=null&&kendoWindowElement!=undefined){if(kendoWindowElement.title!=null&&kendoWindowElement.title!=undefined)kendoWindowElement.title(title);if(kendoWindowElement.refresh!=null&&kendoWindowElement.refresh!=undefined)kendoWindowElement.refresh(url);if(kendoWindowElement.open!=null&&kendoWindowElement.open!=undefined)kendoWindowElement.open().center();}}function showDialogBySize(url,title,width,height,funtion){var uploadwindow=$("#windowbysize");if($("#HiddenValuePopup").length==0){$("#contentRow").append("<input type='hidden' id='HiddenValuePopup'/>");$("#HiddenValuePopup").val("");}if(uploadwindow.length==0){$("#contentRow").append("<div id='windowbysize'></div>");uploadwindow=$("#windowbysize");}var widthOfForm=width;if(parent.$("#windowbysize").data("kendoWindow")!=undefined){parent.$("#windowbysize").addClass("header-vt");if(widthOfForm>parent.$("#windowbysize").width())widthOfForm=parent.$("#windowbysize").width()-30;}if(!uploadwindow.data("kendoWindow")){uploadwindow.kendoWindow({actions:["Close"],iframe:true,visible:false,content:"",close:function(){if(typeof(funtion)==='string'){eval(funtion);}else{funtion();}parent.$("#windowbysize").removeClass("header-vt");uploadwindow.find("#windowbysize").remove();this.destroy();document.body.className='';},refresh:function(){uploadwindow.find(".processcustome-loading-small").remove();},resizable:true,open:function(){uploadwindow.append("<div class='processcustome-loading-small'><img id='img-pro' src='/images/loading.gif'><span>Vui lòng đợi...</span></div>");uploadwindow.width(widthOfForm);uploadwindow.height(height);uploadwindow.data("kendoWindow").center();},modal:true});}if(url.indexOf("?")>0)url=url+"&IsDlg=1";else
url=url+"?IsDlg=1";var kendoWindowElement=uploadwindow.data("kendoWindow");if(kendoWindowElement!=null&&kendoWindowElement!=undefined){if(kendoWindowElement.title!=null&&kendoWindowElement.title!=undefined)kendoWindowElement.title(title);if(kendoWindowElement.refresh!=null&&kendoWindowElement.refresh!=undefined)kendoWindowElement.refresh(url);if(kendoWindowElement.open!=null&&kendoWindowElement.open!=undefined)kendoWindowElement.open().center();}}function ResizeDialog(width,height,isCenter){var WindowElement=parent.$("#windowbysize");WindowElement.width(width);WindowElement.height(height);var KendoWirndowObject=WindowElement.data("kendoWindow");KendoWirndowObject.wrapper.css({width:width,height:height});var iframeDomElement=WindowElement.children("iframe")[0];$(iframeDomElement).width(width);$(iframeDomElement).height(height);KendoWirndowObject.center();KendoWirndowObject.refresh();}function closeDialog(value,object){var IsDlg=getParameterByName("IsDlg");if(IsDlg!=""&&IsDlg=="1"){$("body").removeClass("fixContent");if(object!=null&&object!=undefined)parent.returnObjectPopup=object;parent.$("#HiddenCloseDialogValue").val(value);if(parent.$("#windowbysize").data("kendoWindow")!=undefined)parent.$("#windowbysize").data("kendoWindow").close();}else{if(value!="")window.location=value;else{var source=getParameterByName("Source");if(source!="")window.location=source;else
window.location=window.location.origin;}}}function openLoginWindow(url,isToolbar,w,h){try{url=isEmptyOrSpaces(url)?(window.location.origin+"/LoginPopup.aspx"):url;isToolbar=isNullOrUndefined(isToolbar)?false:isToolbar;w=(isNullOrUndefined(w)||isNaN(parseInt(w)))?400:w;h=(isNullOrUndefined(h)||isNaN(parseInt(h)))?550:h;if(isToolbar){var dualScreenLeft=window.screenLeft!=undefined?window.screenLeft:screen.left;var dualScreenTop=window.screenTop!=undefined?window.screenTop:screen.top;var width=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width;var height=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height;var left=((width/2)-(w/2))+dualScreenLeft;var top=((height/2)-(h/2))+dualScreenTop;var myWindown=window.open(url,"_blank",'scrollbars=yes,resizable=yes, width='+w+', height='+h+', top='+top+', left='+left);myWindown.focus();}else{var myWindown=window.open(url);myWindown.focus();}}catch(e){console.log(e);}}function DeCodeHTML(str){return str.replace(/&#(\d+);/g,function(match,dec){return String.fromCharCode(dec);});}function EnCodeHTML(str){var buf=[];for(var i=str.length-1;i>=0;i--){buf.unshift(['&#',str[i].charCodeAt(),';'].join(''));}return buf.join('');}function SetErrorMessage(message){document.getElementById('messerror').innerText=message;setTimeout(function(){document.getElementById('messerror').innerText='';},3000);HideLoading();}function ShowLoading(){document.getElementById("divLoading").style.display="block";}function HideLoading(){document.getElementById("divLoading").style.display="none";}function isNullOrUndefined(obj){var nullObject=null;return(obj===nullObject||obj===undefined);}function isEmptyOrSpaces(str){return isNullOrUndefined(str)||typeof(str)!='string'||str.match(/^ *$/)!==null;}function getResourceValue(key,defaultValue,module){if(_VNA_PORTAL.LangId==""){return defaultValue;}if(typeof _VTResource==="undefined"){addScript(window.location.origin+"/Scripts/Resource/"+_VNA_PORTAL.LangId+".js");execVTScript();return defaultValue;}if(_VTResource[module]==="undefined"||_VTResource[module][key]==="undefined"){return defaultValue;}return _VTResource[module][key];}function VuThaoNotify(message,style,color){var messerror=$("#messerror");messerror.removeClass("red").removeClass("green");messerror.addClass(color);messerror.html(message);$(".msgError").fadeIn("slow");setTimeout(function(){$(".msgError").fadeOut("slow");},5000);}function truncateText(inputText,maxLen,plusDot){if(inputText==null||inputText.length==0)return'';if(plusDot==null)plusDot=true;var retValue=inputText;if(inputText.length>maxLen){if(plusDot){maxLen=maxLen-3;}var lstChar=inputText.split(' ');retValue='';for(var i=0;i<lstChar.length;i++){if(retValue.length+lstChar[i].length>=maxLen)break;retValue+=lstChar[i]+" ";}if(plusDot)retValue=retValue+"<span class='dot_more'>...</span>";}return retValue;}function CheckLogin(onSuccess,onFailed){FuncGetAPI("/API/ApiUser.ashx?func=checkLogged",onSuccess,onFailed);}function viewImageUpLoad(ctrUpload,tagImgID){if(ctrUpload.files&&ctrUpload.files[0]){var reader=new FileReader();reader.onload=function(e){$("#"+tagImgID).attr("src",e.target.result);showHide_buttonRemoveImg(tagImgID);}
reader.readAsDataURL(ctrUpload.files[0]);}}function showHide_buttonRemoveImg(tagImgID){var srcImg=$("#"+tagImgID).attr("src")+"";if(srcImg!=""&&srcImg!="undefined"){$("#btnRemoveImg").show();}else
$("#btnRemoveImg").hide();}function htmlDecode(value){if(value!=''){return $('<div/>').html(value).text();}else return'';}function CheckInputNumber(objtextbox){var exp=/[^-?\d]/g;if(objtextbox.value!=""){var val=objtextbox.value.replace(exp,"");objtextbox.value=formatNumber(val);}}function formatNumber(num){return num.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.");}function FormValidate(){var result=true;$('Form div.ItemRow div.ItemInput').each(function(){if($(this).prev().find('label').length>0){if($(this).find('input').length>0&&$(this).find('input').is(":visible")&&($(this).find('input').val()==null||$(this).find('input').val().trim()=="")){VuThaoNotify($(this).prev().find('span').text()+" không được rỗng!","none","red");$(this).find('input').focus();HideLoading();return result=false;}if($(this).find('textarea').length>0&&$(this).find('textarea').is(":visible")&&($(this).find('textarea').val()==null||$(this).find('textarea').val().trim()=="")){VuThaoNotify($(this).prev().find('span').text()+" không được rỗng!","none","red");$(this).find('textarea').focus();HideLoading();return result=false;}if($(this).find('select').length>0&&$(this).find('select').is(":visible")&&($(this).find('select option:selected').val().trim()=="0"||$(this).find('select option:selected').val().trim()=="")){VuThaoNotify("Chọn "+$(this).prev().find('span').text()+"!","none","red");$(this).find('select').focus();HideLoading();return result=false;}if($(this).find('input').length>0&&$(this).find('input').data('kendoDatePicker')!=undefined&&$(this).find('input').data('kendoDatePicker').value()==null){VuThaoNotify("Chọn "+$(this).prev().find('span').text()+"!","none","red");$(this).find('input').focus();HideLoading();return result=false;}if($(this).find('input[type="hidden"]').length>0){var hiddenField=$(this).find('input[type="hidden"]');var attr=$(hiddenField).attr('autocomplete');if(typeof attr==typeof undefined&&attr!==false){if(hiddenField.val()==null||hiddenField.val().trim()==""){VuThaoNotify("Chọn "+$(this).prev().find('span').text(),"none","red");HideLoading();return result=false;}}}}});return result;}function GetBeanSearchPropertyObj(strContentType,strKey,strLogicCon,strValue,strValueType){var bean={};bean.ContentType=strContentType;bean.Key=strKey;bean.LogicCon=strLogicCon;bean.Value=encodeURIComponent(strValue);bean.ValueType=strValueType;return bean;}